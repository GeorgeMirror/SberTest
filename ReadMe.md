# Bank Products Project

## Описание

Проект моделирует банковские продукты: дебетовые и кредитные карты, валютные карты, вклады. Архитектура построена по принципам **Clean Architecture** и **DDD (Domain-Driven Design)**.

## Архитектура

- Контракты вынесены отдельно (в `interfaces/`)
- Реализация разделена по доменам (`card/`, `deposit/`)
- Каждая реализация следует структуре: `abs/` (базовая логика) + `impl/` (конкретная реализация)
- Общие абстракции находятся в `core/` и не зависят от конкретных доменов
- Использованы простые конструкторы, а не фабрики

- Обдумано и решено не выносить логику в классы Helper/Mapper/Util.. Этот навык продемонстрирован во второй задаче
  В юнит тестах требуется простота и возможность понять происходящее беглым взглядом
- Параметризованные тесты реализованы в @CsvSource, а не @MethodSource со Stream, для наглядности
- @Step("Шаг") для методов и step("Шаг", () ->{Шаг}) для шагов не применялось, Allure не  указан в ТЗ
- Ниже предоставлен план доработок на случай разрастания проекта

## План доработок
### Улучшить архитектуру и качество кода:
- Заменить вызовы конструкторов на фабрики (Factory Pattern) для создания продуктов (карты, вклады).
- Вынести константы (строки ошибок, коды ошибок) в enum или отдельные константные классы.
- Внедрить использование enum для кодов ошибок и сообщений валидации, убрать магические строки из кода.
- Обеспечить единообразие обработки ошибок и сообщений.
- etc.

### Повысить надежность и читаемость тестов:
- Использовать JUnit5 Parameterized Tests с параметрами в отдельных методах (Stream<Arguments>) для удобства масштабирования.
- Добавить проверки не только типов исключений, но и их сообщений через enum-константы.
- Покрыть позитивные и негативные сценарии, включая граничные значения.
- Использовать @BeforeEach / @AfterEach для подготовки и очистки данных, где это уместно.
- etc.

### Улучшить Allure-отчеты и визуализацию:
- Пометить важные действия и логические блоки кода тестов и бизнес-логики аннотацией @Step.
- Использовать вложенные шаги и Allure.step() для более детального отображения сценариев в отчете.
- Добавить мета-информацию (@Epic, @Feature, @Story, @Severity) к тестам.
- При необходимости — добавить вложенные вложения (скриншоты, логи) для сложных операций.
- etc.

### Расширить тестовые сценарии:
- Добавить примеры с разными валютами, чтобы проверить мультивалютность.
- Применить тест-дизайны:
- Граничные значения (Boundary Value Analysis)
- Попарное тестирование (Pairwise Testing)
- Комбинационное тестирование
- Тестирование с негативными и нулевыми значениями
- Добавить параллельный запуск тестов для ускорения прогонов.
- Добавить интеграционные и end-to-end тесты при наличии внешних зависимостей.
- etc.

### Организация и поддержка кода:
- Вынести общие утилиты и константы в отдельные пакеты.
- Использовать единый стиль кодирования и static import-ы для assert-ов.
- Добавить линтеры и проверки кода в CI.
- Настроить CI/CD для автоматического прогона тестов и публикации Allure отчетов.
- etc.

## Unit-тесты

Реализованы **две параллельные версии unit-тестов**:

### Витринная версия: `BankProductFullTest.java`

- Объединённые тесты всех продуктов
- Использует @Nested, @DisplayName, @Epic, @Feature, @Severity для Allure
- Идеально читается как структурированная спецификация
- Предназначен для ревью, презентаций и демонстрации покрытия

### Промышленная версия: `*Test.java`

- Каждый продукт тестируется отдельно
- Классы: `DebitCardTest`, `CurrencyDebitCardTest`, `CreditCardTest`, `DepositTest`, `CardAbstractTest`
- Отражает best-practices индустрии: SRP, масштабируемость, удобство навигации в IDE

### Данный набор тестов является демонстрационным, часть проверок просто пропущена (if блоки), а не полностью покрывающим боевую логику.
### В реальных проектах тестовый набор нужно расширять в рамках следующих подходов:

- Тестирование граничных значений (Boundary Value Analysis)
- Попарное тестирование (Pairwise Testing)
- Тестирование классов эквивалентности (Equivalence Partitioning)
- Комбинированное тестирование (decision tables, all pairs)
- Функциональное и нефункциональное тестирование по ролям пользователей
- etc.

### Почему два варианта?

> Для **ревьюера** и тимлида удобнее видеть спецификацию в одном файле (BankProductFullTest).
> Для **производственного кода** предпочтительнее отдельные классы с изолированной ответственностью.
> Наличие обоих подходов — **сознательный инженерный выбор**.
> Впрочем, в BankProductFullTest не использовалась параметризация. Он - скорее презентация минимального junit функционала

## Сборка и запуск тестов

```bash
mvn clean test
```

## Allure отчёты

1. Установите Allure CLI: https://docs.qameta.io/allure/
2. Запустите:

```bash
mvn clean test
allure serve target/allure-results
```
